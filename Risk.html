<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å‡ºæ¬¾é£æ§</title>
    <style>
      /* ===== CSS å˜é‡å®šä¹‰ ===== */
      :root {
        --primary-color: #1890ff;
        --primary-dark: #096dd9;
        --primary-light: #e6f7ff;
        --success-color: #52c41a;
        --success-light: #f6ffed;
        --warning-color: #faad14;
        --warning-light: #fffbe6;
        --error-color: #f5222d;
        --error-light: #fff2f0;
        --border-radius: 6px;
        --box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease;
      }

      /* ===== å…¨å±€æ ·å¼ ===== */
      body {
        font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
        line-height: 1.6;
        color: #333;
        margin: 0;
        padding: 20px 20px 20px 170px; /* å·¦ä¾§ç•™å‡ºå¯¼èˆªæ ç©ºé—´ 150px + 20px */
        background-color: #f5f5f5;
        word-break: break-word;
        position: relative;
        transition: padding 0.3s ease;
      }

      /* æ•´ä¸ªé¡µé¢çš„æ»šåŠ¨æ¡æ ·å¼ */
      body::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }

      body::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.05);
        border-radius: 3px;
      }

      body::-webkit-scrollbar-thumb {
        background: rgba(24, 144, 255, 0.5);
        border-radius: 3px;
        transition: all 0.3s ease;
      }

      body::-webkit-scrollbar-thumb:hover {
        background: var(--primary-color);
      }

      /* ===== åŒ…è£…å™¨æ ·å¼ ===== */
      .wrapper {
        max-width: 1400px;
        margin: 0 auto;
      }

      @media (max-width: 1000px) {
        .wrapper {
          max-width: 100%;
        }
      }

      /* ===== å®¹å™¨æ ·å¼ ===== */
      .container {
        background-color: white;
        border-radius: var(--border-radius);
        padding: 20px;
        box-shadow: var(--box-shadow);
        overflow-x: auto;
        max-width: 100%;
      }

      /* å®¹å™¨å†…éƒ¨çš„æ»šåŠ¨æ¡æ ·å¼ */
      .container::-webkit-scrollbar {
        width: 4px;
        height: 4px;
      }

      .container::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.03);
        border-radius: 2px;
      }

      .container::-webkit-scrollbar-thumb {
        background: rgba(24, 144, 255, 0.3);
        border-radius: 2px;
      }

      .container::-webkit-scrollbar-thumb:hover {
        background: var(--primary-color);
      }

      /* ===== æ ‡é¢˜æ ·å¼ ===== */
      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 30px;
        word-break: break-word;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--primary-light);
      }

      .h3-heading {
        font-size: 1.3em;
        font-weight: bold;
        color: #fff;
        margin: 25px 0 20px 0;
        position: relative;
        padding: 12px 20px;
        word-break: break-word;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-dark)
        );
        border-radius: var(--border-radius);
        box-shadow: 0 4px 12px rgba(24, 144, 255, 0.3);
        border-left: 5px solid var(--primary-dark);
        scroll-margin-top: 30px;
      }

      .h4-heading {
        font-size: 1.1em;
        font-weight: bold;
        color: #16a085;
        margin: 15px 0 12px 0;
        position: relative;
        word-break: break-word;
        padding-left: 10px;
        border-left: 4px solid #16a085;
      }

      .h5-heading {
        font-size: 1.1em;
        font-weight: bold;
        color: var(--primary-color);
        margin: 15px 0 10px 0;
        position: relative;
        padding-left: 15px;
        word-break: break-word;
      }

      .h5-heading::before {
        content: "";
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        height: 60%;
        width: 4px;
        background: linear-gradient(
          to bottom,
          var(--primary-color),
          var(--primary-dark)
        );
        border-radius: 2px;
      }

      /* ===== å†…å®¹å—æ ·å¼ ===== */
      .content {
        white-space: pre-wrap;
        margin-bottom: 0;
        line-height: 1.6;
        word-break: break-word;
      }

      .block-line {
        white-space: pre-wrap;
        margin: 0 0 0.8em 0;
        word-break: break-word;
        line-height: 1.7;
      }

      .empty-line {
        height: 1.6em;
        display: block;
        content: " ";
      }

      .p-line {
        background: linear-gradient(135deg, #e8f5e9, #f1f8e9);
        padding: 10px 15px;
        border-radius: 6px;
        margin: 8px 0;
        white-space: pre-wrap;
        word-break: break-word;
        border-left: 4px solid #4caf50;
        box-shadow: 0 2px 6px rgba(76, 175, 80, 0.1);
      }

      #fileContent {
        width: 100%;
        overflow-x: auto;
        word-break: break-word;
      }

      /* ===== å½©è‰²åŒºå—æ ·å¼ ===== */
      .bgb-block {
        background: linear-gradient(135deg, var(--primary-light), #e6f7ff);
        padding: 18px 18px 10px 18px;
        border-radius: 8px;
        margin: 15px 0;
        border-left: 5px solid #69c0ff;
        white-space: pre-wrap;
        word-break: break-word;
        box-shadow: 0 2px 8px rgba(24, 144, 255, 0.1);
      }

      .bgy-block {
        background: linear-gradient(135deg, var(--warning-light), #fffbe6);
        padding: 15px 15px 8px 15px;
        border-radius: 8px;
        margin: 15px 0;
        border-left: 5px solid #ffe58f;
        white-space: pre-wrap;
        word-break: break-word;
        box-shadow: 0 2px 8px rgba(250, 173, 20, 0.1);
      }

      .bgr-block {
        background: linear-gradient(135deg, var(--error-light), #fff2f0);
        padding: 18px 18px 10px 18px;
        border-radius: 8px;
        margin: 15px 0;
        border-left: 5px solid #ffccc7;
        color: var(--error-color);
        white-space: pre-wrap;
        word-break: break-word;
        box-shadow: 0 2px 8px rgba(245, 34, 45, 0.1);
      }

      .bgg-block {
        background: linear-gradient(135deg, var(--success-light), #f6ffed);
        padding: 18px 18px 10px 18px;
        border-radius: 8px;
        margin: 15px 0;
        border-left: 5px solid #b7eb8f;
        white-space: pre-wrap;
        word-break: break-word;
        box-shadow: 0 2px 8px rgba(82, 196, 26, 0.1);
      }

      .box-block {
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        border: 1px solid #e8e8e8;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        white-space: pre-wrap;
        word-break: break-word;
      }

      /* ===== åˆ—è¡¨åŒºå—æ ·å¼ ===== */
      .ul-block {
        background: linear-gradient(135deg, var(--success-light), #f6ffed);
        padding: 20px 20px 15px 15px;
        border-radius: 8px;
        margin: 15px 0;
        border-left: 5px solid #b7eb8f;
        word-break: break-word;
        box-shadow: 0 2px 8px rgba(82, 196, 26, 0.1);
      }

      .ul-block ul {
        margin: 0;
        padding-left: 20px;
        list-style-position: outside;
        word-break: break-word;
      }

      .ul-block li {
        margin-bottom: 8px;
        word-break: break-word;
        white-space: pre-wrap;
        padding-left: 5px;
        line-height: 1.6;
      }

      .ul-block li::marker {
        color: var(--success-color);
        font-weight: bold;
      }

      /* ===== è¡¨æ ¼æ ·å¼ ===== */
      .table-block {
        background-color: white;
        padding: 0;
        border-radius: 12px;
        margin: 20px 0;
        overflow-x: auto;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      .data-table {
        width: 100%;
        table-layout: fixed;
        border-collapse: separate;
        border-spacing: 0;
        font-size: 14px;
      }

      .data-table th,
      .data-table td {
        border: 1px solid #e8e8e8;
        padding: 14px 16px;
        text-align: left;
        word-wrap: break-word;
        transition: background-color 0.2s ease;
      }

      .data-table th {
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-dark)
        );
        color: white;
        font-weight: bold;
        text-align: center;
        position: sticky;
        top: 0;
        font-size: 15px;
        padding: 16px;
      }

      .data-table tr:nth-child(even) {
        background-color: #fafafa;
      }

      .data-table tr:nth-child(odd) {
        background-color: white;
      }

      .data-table tr:hover {
        background-color: #f0f7ff;
      }

      .data-table tr:hover td {
        background-color: transparent;
      }

      .data-table {
        border-radius: 12px;
        overflow: hidden;
      }

      .data-table tr td:first-child {
        font-weight: 600;
        background-color: #f8f9fa;
      }

      .data-table tr:hover td:first-child {
        background-color: #e3f2fd;
      }

      /* ===== æ–‡ä»¶è¾“å…¥æ ·å¼ ===== */
      .file-input {
        margin-bottom: 25px;
        text-align: center;
      }

      .file-input label {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-dark)
        );
        color: white;
        padding: 14px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 550;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(24, 144, 255, 0.3);
        gap: 8px;
      }

      .file-input label:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(24, 144, 255, 0.4);
      }

      .file-input label:active {
        transform: translateY(0);
      }

      .file-input input[type="file"] {
        display: none;
      }

      /* ===== å›¾ç‰‡æ ·å¼ ===== */
      .image-row {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        width: 100%;
        margin: 15px 0;
        justify-content: flex-start;
      }

      .image-container {
        flex: 0 0 calc(25% - 15px);
        min-width: 160px;
        box-sizing: border-box;
        transition: transform 0.3s ease;
      }

      .image-container:hover {
        transform: translateY(-5px);
      }

      .thumbnail {
        width: 100%;
        max-height: 220px;
        height: auto;
        cursor: pointer;
        border-radius: 8px;
        transition: all 0.3s ease;
        object-fit: cover;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        border: 1px solid #f0f0f0;
      }

      .thumbnail:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .thumbnail.loading {
        opacity: 0.7;
        filter: blur(2px);
      }

      /* åŒºå—å†…çš„å›¾ç‰‡è¡Œæ ·å¼ */
      .box-block .image-row,
      .bgb-block .image-row,
      .bgy-block .image-row,
      .bgr-block .image-row,
      .bgg-block .image-row,
      .ul-block .image-row {
        margin-left: 0;
        margin-right: 0;
      }

      .box-block .image-row {
        margin-left: 0;
        margin-right: 0;
        width: calc(100% + 15px);
      }

      /* ===== å›¾ç‰‡æŸ¥çœ‹å™¨æ¨¡æ€æ¡†æ ·å¼ ===== */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.95);
        overflow: auto;
      }

      /* æ¨¡æ€æ¡†æ»šåŠ¨æ¡æ ·å¼ */
      .modal::-webkit-scrollbar {
        width: 3px;
        height: 3px;
      }

      .modal::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 1.5px;
      }

      .modal::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.4);
        border-radius: 1.5px;
      }

      .modal::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.7);
      }

      .modal-content {
        max-width: 90%;
        max-height: 90%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(1);
        transform-origin: center center;
        transition: transform 0.3s ease;
        cursor: zoom-in;
        border-radius: 8px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      .modal-content.draggable {
        cursor: grab;
      }

      .modal-content.dragging {
        cursor: grabbing;
      }

      .close {
        position: absolute;
        top: 20px;
        right: 30px;
        color: #f1f1f1;
        font-size: 45px;
        font-weight: bold;
        cursor: pointer;
        transition: var(--transition);
        z-index: 1001;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 50%;
        backdrop-filter: blur(10px);
      }

      .close:hover {
        color: #fff;
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.1);
      }

      .prev,
      .next {
        cursor: pointer;
        position: absolute;
        top: 50%;
        width: 15px;
        height: 15px;
        padding: 16px;
        margin-top: -30px;
        color: white;
        font-weight: bold;
        font-size: 24px;
        transition: var(--transition);
        user-select: none;
        z-index: 1001;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 50%;
        backdrop-filter: blur(10px);
      }

      .next {
        right: 0px;
      }

      .prev {
        left: 0px;
      }

      .prev:hover,
      .next:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.1);
      }

      .image-info {
        color: #fff;
        text-align: center;
        padding: 15px 20px;
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1001;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 25px;
        backdrop-filter: blur(10px);
        min-width: 120px;
        font-size: 14px;
        font-weight: 500;
      }

      /* ç¼©æ”¾æ§åˆ¶æŒ‰é’® */
      .zoom-controls {
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1001;
        display: flex;
        gap: 8px;
        background: rgba(0, 0, 0, 0.7);
        padding: 10px;
        border-radius: 25px;
        backdrop-filter: blur(10px);
      }

      .zoom-controls button {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: none;
        border-radius: 50%;
        padding: 12px;
        cursor: pointer;
        font-size: 18px;
        transition: var(--transition);
        width: 45px;
        height: 45px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .zoom-controls button:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.1);
      }

      /* åŠ è½½æŒ‡ç¤ºå™¨ */
      .loading-indicator {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 18px;
        z-index: 1002;
        background: rgba(0, 0, 0, 0.8);
        padding: 20px 30px;
        border-radius: 15px;
        backdrop-filter: blur(10px);
      }

      /* ===== ç¤ºä¾‹å†…å®¹æ ·å¼ ===== */
      .demo-content {
        margin-bottom: 30px;
        padding: 20px;
        background: linear-gradient(135deg, #e7fae8, #f0fdf4);
        border-radius: 12px;
        border-left: 5px solid var(--primary-color);
        box-shadow: 0 4px 15px rgba(24, 144, 255, 0.15);
      }

      .demo-title {
        font-weight: bold;
        margin-bottom: 15px;
        color: var(--primary-color);
        font-size: 1.2em;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .demo-content > div {
        margin-bottom: 8px;
        padding: 5px 0;
        border-bottom: 1px dashed #d4edda;
      }

      .demo-content > div:last-child {
        border-bottom: none;
        margin-bottom: 0;
      }

      /* ===== å·¦ä¾§å¯¼èˆªæ æ ·å¼ ===== */
      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        width: 150px;
        height: 100vh;
        background-color: #fff;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        padding: 20px 0;
        overflow-y: auto;
        z-index: 100;
        transition: transform 0.3s ease;
      }

      /* å¯¼èˆªæ æ»šåŠ¨æ¡æ ·å¼ */
      .sidebar::-webkit-scrollbar {
        width: 4px;
      }

      .sidebar::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.05);
      }

      .sidebar::-webkit-scrollbar-thumb {
        background: rgba(24, 144, 255, 0.3);
        border-radius: 2px;
      }

      .sidebar::-webkit-scrollbar-thumb:hover {
        background: var(--primary-color);
      }

      /* æ”¶èµ·çŠ¶æ€ä»…å®½åº¦å˜å°ï¼Œä¸å†translateXéšè— */
      .sidebar.collapsed {
        width: 50px;
        transition: width 0.3s ease;
      }

      .sidebar.collapsed .sidebar-title {
        display: none; /* æ”¶èµ·æ—¶éšè—æ ‡é¢˜ */
      }

      /* æ”¶èµ·æ—¶å¯¼èˆªé¡¹åªæ˜¾ç¤ºå›¾æ ‡ */
      .sidebar.collapsed .nav-item-text {
        display: none;
      }

      /* æ”¶èµ·æ—¶è°ƒæ•´å¯¼èˆªé¡¹æ ·å¼ */
      .sidebar.collapsed .nav-item {
        text-align: center;
        padding: 8px 0;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      /* ç¡®ä¿å›¾æ ‡åœ¨æ”¶èµ·çŠ¶æ€ä¸‹æ­£å¸¸æ˜¾ç¤º */
      .sidebar.collapsed .nav-item-icon {
        display: inline-block !important; /* ä½¿ç”¨importantç¡®ä¿ä¼˜å…ˆçº§ */
        margin-right: 0;
        font-size: 18px; /* ç¨å¾®å¢å¤§å›¾æ ‡ */
      }

      .sidebar-title {
        padding: 0 15px 15px;
        font-weight: bold;
        border-bottom: 1px solid #eee;
        margin-bottom: 10px;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .nav-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .nav-item {
        padding: 8px 15px;
        cursor: pointer;
        transition: var(--transition);
        font-size: 13px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        border-left: 3px solid transparent;
      }

      .nav-item:hover {
        background-color: var(--primary-light);
        color: var(--primary-color);
        border-left-color: var(--primary-color);
      }

      .nav-item.active {
        background-color: var(--primary-color);
        color: white;
        border-left-color: var(--primary-dark);
      }

      /* å¯¼èˆªé¡¹é‡Œçš„å›¾æ ‡ */
      .nav-item-icon {
        display: inline-block;
        width: 20px;
        text-align: center;
        margin-right: 8px;
        font-size: 16px;
        transition: all 0.3s ease;
      }

      .nav-item-icon.primary {
        color: var(--primary-color);
      }
      .nav-item-icon.success {
        color: var(--success-color);
      }
      .nav-item-icon.warning {
        color: var(--warning-color);
      }
      .nav-item-icon.error {
        color: var(--error-color);
      }
      .nav-item-icon.purple {
        color: #722ed1;
      }
      .nav-item-icon.cyan {
        color: #13c2c2;
      }
      .nav-item-icon.magenta {
        color: #eb2f96;
      }
      .nav-item-icon.orange {
        color: #fa8c16;
      }

      /* å¯¼èˆªæ åˆ‡æ¢æŒ‰é’®æ ·å¼ */
      .sidebar-toggle {
        position: fixed;
        left: 150px;
        top: 10px;
        width: 20px;
        height: 40px;
        background-color: var(--primary-color);
        color: white;
        border-radius: 0 4px 4px 0;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 101;
        transition: left 0.3s ease;
      }

      .sidebar-toggle span {
        font-size: 14px;
        transition: transform 0.3s ease;
        user-select: none;
      }

      .sidebar-toggle.collapsed span {
        transform: rotate(180deg);
      }

      /* æ”¶èµ·æ—¶è°ƒæ•´ toggle æŒ‰é’®ä½ç½® */
      .sidebar-toggle.collapsed {
        left: 50px;
      }

      /* ===== è‡ªå®šä¹‰ Tooltip æ ·å¼ å·¦ä¾§å¯¼èˆªæ‚¬åœæç¤º===== */
      /*
      .tooltip {
        position: absolute;
        background: rgba(0, 0, 0, 0.85);
        color: #fff;
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 14px;
        white-space: nowrap;
        pointer-events: none;
        opacity: 0;
        transform: translateY(-50%) scale(0.95);
        transition: opacity 0.2s ease, transform 0.2s ease;
        z-index: 2000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
      }

      .tooltip.show {
        opacity: 1;
        transform: translateY(-50%) scale(1);
      }
        */
      /* ===== ç¾åŒ–åçš„ Tooltip æ ·å¼ ===== */
      .tooltip {
        position: absolute;
        background: linear-gradient(135deg, #1890ff, #096dd9);
        color: #fff;
        padding: 8px 14px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        white-space: nowrap;
        pointer-events: none;
        opacity: 0;
        transform: translateY(-50%) scale(0.95);
        transition: opacity 0.3s ease, transform 0.3s ease;
        z-index: 2000;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
      }
      .tooltip.show {
        opacity: 1;
        transform: translateY(-50%) translateX(4px) scale(1);
      }
      .tooltip::after {
        content: "";
        position: absolute;
        left: -6px;
        top: 50%;
        transform: translateY(-50%);
        border-width: 6px;
        border-style: solid;
        border-color: transparent #1890ff transparent transparent;
      }

      /* ä¸åŒä¸»é¢˜é¢œè‰² */
      .tooltip.warning {
        background: linear-gradient(135deg, #faad14, #ffc53d);
      }
      .tooltip.warning::after {
        border-color: transparent #faad14 transparent transparent;
      }

      .tooltip.success {
        background: linear-gradient(135deg, #52c41a, #73d13d);
      }
      .tooltip.success::after {
        border-color: transparent #52c41a transparent transparent;
      }

      .tooltip.error {
        background: linear-gradient(135deg, #f5222d, #ff7875);
      }
      .tooltip.error::after {
        border-color: transparent #f5222d transparent transparent;
      }

      .tooltip.info {
        background: linear-gradient(135deg, #1890ff, #40a9ff);
      }
      .tooltip.info::after {
        border-color: transparent #1890ff transparent transparent;
      }

      /* ===== æ— éšœç¢ä¼˜åŒ– ===== */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      /* ===== å“åº”å¼è®¾è®¡ ===== */
      @media (max-width: 1024px) {
        .image-container {
          flex: 0 0 calc(33.333% - 15px);
        }
      }

      @media (max-width: 768px) {
        body {
          padding: 15px;
        }

        .sidebar {
          transform: translateX(-150px);
        }

        .sidebar-toggle {
          left: 0;
        }

        .container {
          padding: 15px;
        }

        h1 {
          font-size: 1.8em;
          margin-bottom: 20px;
        }

        .file-input label {
          padding: 12px 20px;
          font-size: 15px;
        }

        .image-container {
          flex: 0 0 calc(50% - 15px);
        }

        .data-table {
          display: block;
          overflow-x: auto;
          white-space: nowrap;
        }

        .data-table th,
        .data-table td {
          min-width: 120px;
          padding: 12px;
        }
      }

      @media (max-width: 480px) {
        .image-container {
          flex: 0 0 100%;
        }
      }

      /* åˆ—è¡¨é¡¹æ ·å¼é‡ç½® */
      li {
        list-style: none;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <!-- å·¦ä¾§å¯¼èˆªæ  -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-title">ğŸ›¡ï¸é£æ§è§„åˆ™å¯¼èˆª</div>
      <ul class="nav-list" id="navList"></ul>
    </div>

    <!-- å¯¼èˆªæ åˆ‡æ¢æŒ‰é’® -->
    <div class="sidebar-toggle" id="sidebarToggle">
      <span>â€¹</span>
    </div>

    <!-- æ·»åŠ åŒ…è£…å™¨ -->
    <div class="wrapper">
      <div class="container">
        <h1>å·´è¥¿ç”µå­é£æ§æµç¨‹</h1>

        <div class="file-input" id="fileInputContainer">
          <label for="fileInput">
            ğŸ“„
            <span class="sr-only">é€‰æ‹©TXTæ–‡ä»¶</span>
            <span aria-hidden="true">é€‰æ‹©TXTæ–‡ä»¶</span>
          </label>
          <input
            type="file"
            id="fileInput"
            accept=".txt"
            aria-label="é€‰æ‹©TXTæ–‡ä»¶"
          />
        </div>

        <!-- ç¤ºä¾‹å†…å®¹ -->
        <div id="demoContent">
          <div class="demo-content">
            <div class="demo-title">ğŸ“‹ åŠŸèƒ½ç¤ºä¾‹ï¼š</div>
            <div>
              1. ä½¿ç”¨ <strong>h3</strong> å’Œ <strong>h4</strong>ã€<strong
                >h5</strong
              >
              ä½œä¸ºæ ‡é¢˜
            </div>
            <div>2. ä½¿ç”¨ <strong>bgb/bgy/bgr/bgg</strong> åˆ›å»ºå½©è‰²åŒºå—</div>
            <div>
              3. ä½¿ç”¨ <strong>ul</strong> å’Œ <strong>uld</strong> åŒ…è£¹åˆ—è¡¨å†…å®¹
            </div>
            <div>
              4. ä½¿ç”¨ <strong>box</strong> å’Œ <strong>boxd</strong> åˆ›å»ºç™½è‰²å¡ç‰‡
            </div>
            <div>5. ä½¿ç”¨ <strong>P </strong> å¼€å¤´çš„è¡Œä¼šæœ‰æ·¡ç»¿è‰²èƒŒæ™¯</div>
            <div>
              6. ä½¿ç”¨ <strong>table</strong> å’Œ
              <strong>tabled</strong>
              åˆ›å»ºè¡¨æ ¼ï¼Œ#å¼€å¤´çš„è¡Œæ˜¯è¡¨å¤´,<strong> | </strong>éš”å¼€è¡¨ç¤ºæ¯ä¸ªå•å…ƒæ ¼
            </div>
            <div>7. ä½¿ç”¨ <strong>./å›¾ç‰‡è·¯å¾„</strong> æ’å…¥å›¾ç‰‡</div>
          </div>
        </div>

        <div id="fileContent"></div>
      </div>
    </div>

    <!-- å›¾ç‰‡æŸ¥çœ‹å™¨æ¨¡æ€æ¡† -->
    <div
      id="imageModal"
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="imageInfo"
    >
      <span class="close" aria-label="å…³é—­å›¾ç‰‡">&times;</span>
      <span class="prev" aria-label="ä¸Šä¸€å¼ å›¾ç‰‡">&#10094;</span>
      <span class="next" aria-label="ä¸‹ä¸€å¼ å›¾ç‰‡">&#10095;</span>
      <div class="zoom-controls">
        <button class="zoom-in" aria-label="æ”¾å¤§å›¾ç‰‡">+</button>
        <button class="zoom-out" aria-label="ç¼©å°å›¾ç‰‡">-</button>
        <button class="zoom-reset" aria-label="é‡ç½®å›¾ç‰‡å¤§å°">â†º</button>
      </div>
      <div class="loading-indicator" id="loadingIndicator">ğŸ”„ åŠ è½½ä¸­...</div>
      <img class="modal-content" id="modalImage" alt="é¢„è§ˆå›¾ç‰‡" />
      <div class="image-info" id="imageInfo"></div>
    </div>

    <script>
      // ===== ä¸»åº”ç”¨ç¨‹åº =====
      // ä½¿ç”¨æ¨¡å—æ¨¡å¼å°è£…ä»£ç ï¼Œé¿å…å…¨å±€æ±¡æŸ“
      (function () {
        // ===== DOM å…ƒç´ ç¼“å­˜ =====
        const domCache = {
          fileInputContainer: document.getElementById("fileInputContainer"),
          demoContent: document.getElementById("demoContent"),
          fileContent: document.getElementById("fileContent"),
          imageModal: document.getElementById("imageModal"),
          modalImage: document.getElementById("modalImage"),
          imageInfo: document.getElementById("imageInfo"),
          loadingIndicator: document.getElementById("loadingIndicator"),
          zoomInBtn: document.querySelector(".zoom-in"),
          zoomOutBtn: document.querySelector(".zoom-out"),
          zoomResetBtn: document.querySelector(".zoom-reset"),
          closeBtn: document.querySelector(".close"),
          prevBtn: document.querySelector(".prev"),
          nextBtn: document.querySelector(".next"),
          navList: document.getElementById("navList"),
          sidebar: document.getElementById("sidebar"),
          sidebarToggle: document.getElementById("sidebarToggle"),
          fileInput: document.getElementById("fileInput"),
        };

        // ===== å…¨å±€çŠ¶æ€ç®¡ç† =====
        const state = {
          allImages: [],
          currentImageIndex: 0,
          currentImageRow: null,
          currentScale: 1,
          isDragging: false,
          translateX: 0,
          translateY: 0,
          lastClickTime: 0,
          startX: 0,
          startY: 0,
          preloadIndex: -1,
          h3Headings: [], // å­˜å‚¨æ‰€æœ‰h3æ ‡é¢˜
          lastActiveIndex: -1, // è®°å½•ä¸Šæ¬¡æ¿€æ´»çš„å¯¼èˆªé¡¹ç´¢å¼•
          sidebarCollapsed: false, // ä¾§è¾¹æ çŠ¶æ€
        };

        // ===== åˆå§‹åŒ–å‡½æ•° =====
        function init() {
          setupEventListeners();
          showDemoContent();
          setupScrollSpy();
        }

        // ===== äº‹ä»¶ç›‘å¬å™¨è®¾ç½® =====
        function setupEventListeners() {
          domCache.fileInput.addEventListener("change", handleFileSelect);

          // ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¤„ç†å›¾ç‰‡ç‚¹å‡»
          domCache.fileContent.addEventListener("click", function (e) {
            if (e.target.classList.contains("thumbnail")) {
              openModal(e.target.src);
            }
          });

          // æ¨¡æ€æ¡†ç›¸å…³äº‹ä»¶
          domCache.closeBtn.addEventListener("click", closeModal);
          domCache.prevBtn.addEventListener("click", showPrevImage);
          domCache.nextBtn.addEventListener("click", showNextImage);
          domCache.zoomInBtn.addEventListener("click", handleZoomIn);
          domCache.zoomOutBtn.addEventListener("click", handleZoomOut);
          domCache.zoomResetBtn.addEventListener("click", handleZoomReset);

          // å›¾ç‰‡æ‹–åŠ¨ç›¸å…³äº‹ä»¶
          domCache.modalImage.addEventListener("mousedown", startDrag);
          document.addEventListener("mousemove", handleDrag);
          document.addEventListener("mouseup", endDrag);

          // æ–°å¢æ»šè½®ç¼©æ”¾äº‹ä»¶ç›‘å¬
          domCache.modalImage.addEventListener("wheel", handleWheelZoom, {
            passive: false,
          });

          // æ–°å¢ç‚¹å‡»æ”¾å¤§/ç¼©å°åŠŸèƒ½
          domCache.modalImage.addEventListener("click", function (e) {
            // åªæœ‰å½“æ²¡æœ‰æ‹–åŠ¨æ“ä½œæ—¶æ‰å¤„ç†ç‚¹å‡»
            if (!state.isDragging) {
              e.stopPropagation();
              const now = Date.now();

              // åŒå‡»å¤„ç†
              if (now - state.lastClickTime < 300) {
                if (state.currentScale === 1) {
                  zoomImage(2);
                } else {
                  resetImageZoom();
                }
              }
              state.lastClickTime = now;
            }
            // é‡ç½®æ‹–åŠ¨çŠ¶æ€
            state.isDragging = false;
            domCache.modalImage.classList.remove("dragging");
          });

          // é”®ç›˜å¯¼èˆª
          document.addEventListener("keydown", handleKeyDown);

          // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
          domCache.imageModal.addEventListener("click", function (e) {
            if (e.target === domCache.imageModal) {
              closeModal();
            }
          });

          // æ–°å¢ï¼šä¾§è¾¹æ åˆ‡æ¢äº‹ä»¶
          domCache.sidebarToggle.addEventListener("click", toggleSidebar);
        }

        // ===== ä¾§è¾¹æ åŠŸèƒ½ =====
        function toggleSidebar() {
          state.sidebarCollapsed = !state.sidebarCollapsed;

          if (state.sidebarCollapsed) {
            domCache.sidebar.classList.add("collapsed");
            domCache.sidebarToggle.classList.add("collapsed");
            document.body.style.paddingLeft = "70px";
          } else {
            domCache.sidebar.classList.remove("collapsed");
            domCache.sidebarToggle.classList.remove("collapsed");
            document.body.style.paddingLeft = "170px";
          }
        }

        // ===== æ»šåŠ¨ç›‘å¬åŠŸèƒ½ =====
        function setupScrollSpy() {
          window.addEventListener("scroll", function () {
            if (state.h3Headings.length === 0) return;

            const scrollPosition = window.scrollY;
            const windowHeight = window.innerHeight;
            const triggerPosition = windowHeight * 0.3; // 30%ä½ç½®è§¦å‘

            // æ‰¾åˆ°å½“å‰åº”è¯¥æ¿€æ´»çš„h3æ ‡é¢˜
            let activeIndex = -1;

            for (let i = 0; i < state.h3Headings.length; i++) {
              const heading = document.getElementById(state.h3Headings[i].id);
              if (heading) {
                const rect = heading.getBoundingClientRect();
                if (rect.top <= triggerPosition) {
                  activeIndex = i;
                } else {
                  break;
                }
              }
            }

            // å¦‚æœæ‰¾åˆ°äº†æ–°çš„æ¿€æ´»é¡¹ä¸”ä¸ä¸Šæ¬¡ä¸åŒï¼Œåˆ™æ›´æ–°
            if (activeIndex !== -1 && activeIndex !== state.lastActiveIndex) {
              state.lastActiveIndex = activeIndex;
              updateActiveNavItem(activeIndex);
            }
          });
        }

        // æ›´æ–°æ¿€æ´»çš„å¯¼èˆªé¡¹
        function updateActiveNavItem(index) {
          const navItems = document.querySelectorAll(".nav-item");
          navItems.forEach((item, i) => {
            if (i === index) {
              item.classList.add("active");
            } else {
              item.classList.remove("active");
            }
          });
        }

        // ===== æ–‡ä»¶å¤„ç†åŠŸèƒ½ =====
        function handleFileSelect(e) {
          const file = e.target.files[0];
          if (!file) return;

          domCache.fileInputContainer.style.display = "none";
          hideDemoContent();

          const reader = new FileReader();

          reader.onload = function (e) {
            const content = e.target.result;
            displayContent(content);
          };

          reader.onerror = function () {
            alert("æ–‡ä»¶è¯»å–å¤±è´¥ï¼Œè¯·é‡è¯•");
            resetUI();
          };

          reader.readAsText(file, "UTF-8");
        }

        // é‡ç½®UIçŠ¶æ€
        function resetUI() {
          domCache.fileInputContainer.style.display = "block";
          showDemoContent();
          domCache.fileContent.innerHTML = "";
          state.allImages = [];
          state.currentImageRow = null;
          state.h3Headings = [];
          state.lastActiveIndex = -1;
          domCache.navList.innerHTML = "";
        }

        // æ˜¾ç¤ºç¤ºä¾‹å†…å®¹
        function showDemoContent() {
          domCache.demoContent.style.display = "block";
        }

        // éšè—ç¤ºä¾‹å†…å®¹
        function hideDemoContent() {
          domCache.demoContent.style.display = "none";
        }

        // ===== å†…å®¹æ˜¾ç¤ºåŠŸèƒ½ =====
        function displayContent(content) {
          domCache.fileContent.innerHTML = "";
          state.allImages = []; // æ¸…ç©ºå›¾ç‰‡æ•°ç»„
          state.currentImageRow = null; // é‡ç½®å½“å‰å›¾ç‰‡è¡Œ
          state.h3Headings = []; // æ¸…ç©ºh3æ ‡é¢˜æ•°ç»„
          state.lastActiveIndex = -1; // é‡ç½®æœ€åæ¿€æ´»çš„å¯¼èˆªé¡¹ç´¢å¼•

          const lines = content.split("\n");
          let i = 0;

          while (i < lines.length) {
            const line = lines[i];
            const trimmedLine = line.trim();

            // å¤„ç†å—
            if (
              ["bgb", "bgy", "bgr", "bgg", "box", "ul", "table"].includes(
                trimmedLine
              )
            ) {
              const blockType = trimmedLine;
              let blockLines = [];
              i++;
              while (i < lines.length && lines[i].trim() !== blockType + "d") {
                blockLines.push(lines[i]);
                i++;
              }

              if (blockLines.length > 0) {
                const block =
                  blockType === "ul"
                    ? processListContent(blockLines)
                    : blockType === "table"
                    ? createTable(blockLines)
                    : processBlock(blockLines, blockType);
                domCache.fileContent.appendChild(block);
              }
              i++;
              continue;
            }

            // å¤„ç†æ™®é€šå†…å®¹
            if (trimmedLine.startsWith("h3")) {
              domCache.fileContent.appendChild(createHeading(line, true));
            } else if (
              trimmedLine.startsWith("h4") ||
              trimmedLine.startsWith("h5")
            ) {
              domCache.fileContent.appendChild(createHeading(line, false));
            } else {
              domCache.fileContent.appendChild(createLine(line));
            }

            i++;
          }
        }

        // ===== æ ‡é¢˜åˆ›å»ºåŠŸèƒ½ =====
        function createHeading(line, isH3) {
          const heading = document.createElement("div");
          if (isH3) {
            heading.className = "h3-heading";
            const id = "section-" + state.h3Headings.length;
            heading.id = id;

            const headingText = line.substring(2).trim();
            const icon = getIconForSection(headingText);

            // å­˜å‚¨h3æ ‡é¢˜ä¿¡æ¯
            state.h3Headings.push({
              id: id,
              text: headingText,
              icon: icon,
            });

            // æ›´æ–°å¯¼èˆªæ 
            updateNavigation();
          } else if (line.startsWith("h4")) {
            heading.className = "h4-heading";
          } else if (line.startsWith("h5")) {
            heading.className = "h5-heading";
          }
          heading.textContent = line.substring(2).trim();
          return heading;
        }

        // ===== å¯¼èˆªæ åŠŸèƒ½ =====
        function updateNavigation() {
          domCache.navList.innerHTML = "";
          const iconStyles = [
            "primary",
            "success circle",
            "warning pulse",
            "error square",
            "purple spin",
            "cyan bounce",
            "magenta",
            "orange tada",
          ];

          const icons = [
            "â“",
            "â­ï¸",
            "ğŸ‘€",
            "ğŸ¤”",
            "ğŸ”’",
            "ğŸª¥",
            "ğŸ¤‘",
            "â°",
            "ğŸ“…",
            "âœï¸",
            "ğŸ§ ",
            "ğŸ“",
            "ğŸ®",
            "ğŸ“¦",
          ];

          state.h3Headings.forEach((heading, index) => {
            const li = document.createElement("li");
            li.className = "nav-item";
            li.dataset.id = heading.id;

            // å›¾æ ‡ - å¾ªç¯ä½¿ç”¨ä¸åŒçš„æ ·å¼
            const icon = document.createElement("span");
            const iconStyle = iconStyles[index % iconStyles.length];
            icon.className = `nav-item-icon ${iconStyle}`;
            icon.textContent = icons[index % icons.length];

            // ç»™å›¾æ ‡æ·»åŠ titleå±æ€§ï¼Œæ˜¾ç¤ºå½“å‰æ ‡é¢˜
            icon.setAttribute("data-tooltip", heading.text);

            // æ–‡æœ¬
            const text = document.createElement("span");
            text.className = "nav-item-text";
            text.textContent = heading.text;

            li.appendChild(icon);
            li.appendChild(text);

            li.addEventListener("click", function (e) {
              e.preventDefault();
              scrollToSection(heading.id);
              state.lastActiveIndex = index;
              updateActiveNavItem(index);
            });
            domCache.navList.appendChild(li);
          });

          if (state.h3Headings.length > 0) {
            state.lastActiveIndex = 0;
            updateActiveNavItem(0);
          }
        }

        // æ·»åŠ ä¸€ä¸ªå‡½æ•°æ¥è·å–é€‚åˆçš„å›¾æ ‡
        function getIconForSection(sectionName) {
          const iconMap = {
            è§„åˆ™: "ğŸ“‹",
            å®¡æ ¸: "âœ…",
            è­¦å‘Š: "âš ï¸",
            æ‹’ç»: "âŒ",
            å®¡æŸ¥: "ğŸ”",
            ç»Ÿè®¡: "ğŸ“Š",
            æ—¶é—´: "â°",
            ç‰¹æ®Š: "â­",
            é£é™©: "ğŸ›¡ï¸",
            ç”¨æˆ·: "ğŸ‘¤",
            æ”¯ä»˜: "ğŸ’³",
            äº¤æ˜“: "ğŸ’°",
            ç³»ç»Ÿ: "âš™ï¸",
            æ—¥å¿—: "ğŸ“",
            è®¾ç½®: "ğŸ”§",
            å¸®åŠ©: "â“",
          };

          for (const [key, icon] of Object.entries(iconMap)) {
            if (sectionName.includes(key)) {
              return icon;
            }
          }

          // é»˜è®¤å›¾æ ‡
          return "ğŸ“„";
        }

        // æ»šåŠ¨åˆ°æŒ‡å®šç« èŠ‚
        function scrollToSection(id) {
          const element = document.getElementById(id);
          if (element) {
            // è®¡ç®—æ­£ç¡®çš„åç§»é‡ï¼ˆå¯¼èˆªæ é«˜åº¦ + é¢å¤–é—´è·ï¼‰
            const navHeight =
              document.querySelector(".sidebar").offsetHeight || 0;
            const offset = 25; // ä½ æƒ³è¦çš„30pxé—´è·
            const targetPosition = element.offsetTop - offset;
            const startPosition = window.pageYOffset;
            const distance = targetPosition - startPosition;
            const duration = 500;
            let startTime = null;

            function animation(currentTime) {
              if (startTime === null) startTime = currentTime;
              const timeElapsed = currentTime - startTime;
              const run = easeInOutQuad(
                timeElapsed,
                startPosition,
                distance,
                duration
              );
              window.scrollTo(0, run);
              if (timeElapsed < duration) requestAnimationFrame(animation);
            }

            function easeInOutQuad(t, b, c, d) {
              t /= d / 2;
              if (t < 1) return (c / 2) * t * t + b;
              t--;
              return (-c / 2) * (t * (t - 2) - 1) + b;
            }

            requestAnimationFrame(animation);
          }
        }

        // ===== å†…å®¹è¡Œåˆ›å»ºåŠŸèƒ½ =====
        function createLine(line, parentElement = null) {
          // æ£€æŸ¥æ˜¯å¦æ˜¯å›¾ç‰‡è·¯å¾„
          if (line.trim().startsWith("./")) {
            return createImageElement(line.trim(), parentElement);
          }

          // å¦‚æœæ²¡æœ‰æŒ‡å®šçˆ¶å…ƒç´ ï¼Œé‡ç½®currentImageRow
          if (!parentElement) {
            state.currentImageRow = null;
          }

          const div = document.createElement("div");
          if (line === "") {
            div.className = "empty-line";
            div.innerHTML = "&nbsp;";
          } else if (line.startsWith("P ")) {
            div.className = "p-line";
            div.textContent = line.substring(2);
          } else {
            div.className = "block-line";
            div.textContent = line;
          }
          return div;
        }

        // ===== å›¾ç‰‡å¤„ç†åŠŸèƒ½ =====
        function createImageElement(imagePath, parentElement = null) {
          // æ·»åŠ åˆ°å…¨å±€å›¾ç‰‡æ•°ç»„
          const index = state.allImages.length;
          state.allImages.push(imagePath);

          // åˆ›å»ºå›¾ç‰‡å®¹å™¨
          const imageContainer = document.createElement("div");
          imageContainer.className = "image-container";

          // åˆ›å»ºå›¾ç‰‡å…ƒç´ 
          const img = document.createElement("img");
          img.src = imagePath;
          img.className = "thumbnail loading";
          img.alt = "å†…å®¹å›¾ç‰‡";
          img.dataset.index = index;

          // å›¾ç‰‡åŠ è½½å¤„ç†
          img.onload = function () {
            img.classList.remove("loading");
          };
          img.onerror = function () {
            img.alt = "å›¾ç‰‡åŠ è½½å¤±è´¥";
            img.classList.remove("loading");
          };

          imageContainer.appendChild(img);

          // å…³é”®ä¿®æ”¹ï¼šç»Ÿä¸€å¤„ç†å›¾ç‰‡è¡Œåˆ›å»º
          const targetParent = parentElement || domCache.fileContent;

          // æŸ¥æ‰¾æœ€è¿‘çš„å›¾ç‰‡è¡Œï¼ˆæ£€æŸ¥æœ€å3ä¸ªå­å…ƒç´ ï¼‰
          let imageRow = null;
          const children = targetParent.children;
          for (
            let i = children.length - 1;
            i >= Math.max(0, children.length - 3);
            i--
          ) {
            if (children[i].classList.contains("image-row")) {
              imageRow = children[i];
              break;
            }
          }

          // å¦‚æœæ²¡æœ‰æ‰¾åˆ°å›¾ç‰‡è¡Œæˆ–å½“å‰è¡Œå·²æ»¡ï¼ˆ4å¼ å›¾ç‰‡ï¼‰ï¼Œåˆ›å»ºæ–°è¡Œ
          if (
            !imageRow ||
            imageRow.querySelectorAll(".image-container").length >= 4
          ) {
            imageRow = document.createElement("div");
            imageRow.className = "image-row";
            targetParent.appendChild(imageRow);
          }

          // å°†å›¾ç‰‡å®¹å™¨æ·»åŠ åˆ°è¡Œä¸­
          imageRow.appendChild(imageContainer);

          return document.createElement("div"); // è¿”å›ç©ºdivå ä½
        }

        // ===== è¡¨æ ¼å¤„ç†åŠŸèƒ½ =====
        function createTable(tableLines) {
          const tableDiv = document.createElement("div");
          tableDiv.className = "table-block";

          const table = document.createElement("table");
          table.className = "data-table";

          // é¦–å…ˆç¡®å®šè¡¨æ ¼çš„æœ€å¤§åˆ—æ•°
          let maxColumns = 0;
          tableLines.forEach((line) => {
            const normalizedLine = line.replace(/[ã€Â·]/g, "|");
            const cells = normalizedLine.split("|").map((cell) => cell.trim());
            if (cells.length > maxColumns) {
              maxColumns = cells.length;
            }
          });

          // å¤„ç†æ¯ä¸€è¡Œ
          tableLines.forEach((line, rowIndex) => {
            const row = document.createElement("tr");

            // ç»Ÿä¸€æ›¿æ¢æ‰€æœ‰åˆ†éš”ç¬¦ä¸º|ï¼Œç„¶ååˆ†å‰²
            const normalizedLine = line.replace(/[ã€Â·]/g, "|");
            let cells = normalizedLine.split("|").map((cell) => cell.trim());

            // å¡«å……ç¼ºå¤±çš„å•å…ƒæ ¼
            while (cells.length < maxColumns) {
              cells.push(""); // æ·»åŠ ç©ºå•å…ƒæ ¼
            }

            // å¦‚æœæ˜¯è¡¨å¤´è¡Œ(ä»¥#å¼€å¤´)
            if (line.trim().startsWith("#")) {
              cells[0] = cells[0].substring(1); // å»æ‰#å·

              cells.forEach((cellText) => {
                const th = document.createElement("th");
                th.textContent = cellText || " "; // ç©ºå•å…ƒæ ¼æ˜¾ç¤ºç©ºæ ¼
                th.setAttribute("scope", "col");
                row.appendChild(th);
              });
            } else {
              cells.forEach((cellText, cellIndex) => {
                const td = document.createElement("td");
                td.textContent = cellText || " "; // ç©ºå•å…ƒæ ¼æ˜¾ç¤ºç©ºæ ¼
                if (cellIndex === 0) {
                  td.classList.add("first-column");
                }
                row.appendChild(td);
              });
            }

            table.appendChild(row);
          });

          tableDiv.appendChild(table);
          return tableDiv;
        }

        // ===== å—å†…å®¹å¤„ç†åŠŸèƒ½ =====
        function processBlock(lines, blockType) {
          const block = document.createElement("div");
          block.className = blockType + "-block";

          let i = 0;
          while (i < lines.length) {
            const line = lines[i];
            const trimmedLine = line.trim();

            // å¤„ç†åµŒå¥—å—
            if (
              ["bgb", "bgy", "bgr", "bgg", "box", "ul", "table"].includes(
                trimmedLine
              )
            ) {
              const nestedBlockType = trimmedLine;
              let blockLines = [];
              i++;
              while (
                i < lines.length &&
                lines[i].trim() !== nestedBlockType + "d"
              ) {
                blockLines.push(lines[i]);
                i++;
              }

              if (blockLines.length > 0) {
                const nestedBlock =
                  nestedBlockType === "ul"
                    ? processListContent(blockLines)
                    : nestedBlockType === "table"
                    ? createTable(blockLines)
                    : processBlock(blockLines, nestedBlockType);
                block.appendChild(nestedBlock);
              }
              i++;
              continue;
            }

            // å¤„ç†æ ‡é¢˜
            if (trimmedLine.startsWith("h3")) {
              block.appendChild(createHeading(line, true));
              i++;
            } else if (
              trimmedLine.startsWith("h4") ||
              trimmedLine.startsWith("h5")
            ) {
              block.appendChild(createHeading(line, false));
              i++;
            }
            // å¤„ç†æ™®é€šå†…å®¹ï¼ˆåŒ…æ‹¬ç©ºè¡Œå’Œå›¾ç‰‡ï¼‰
            else {
              const lineDiv = createLine(line, block);
              block.appendChild(lineDiv);
              i++;
            }
          }

          return block;
        }

        // ===== åˆ—è¡¨å†…å®¹å¤„ç†åŠŸèƒ½ =====
        function processListContent(lines) {
          const listContainer = document.createElement("div");
          listContainer.className = "ul-block";
          const ul = document.createElement("ul");

          let i = 0;
          while (i < lines.length) {
            const line = lines[i];
            const trimmedLine = line.trim();

            // å¤„ç†åµŒå¥—å—
            if (
              ["bgb", "bgy", "bgr", "bgg", "box", "ul", "table"].includes(
                trimmedLine
              )
            ) {
              const blockType = trimmedLine;
              let blockLines = [];
              i++;
              while (i < lines.length && lines[i].trim() !== blockType + "d") {
                blockLines.push(lines[i]);
                i++;
              }

              if (blockLines.length > 0) {
                const block =
                  blockType === "table"
                    ? createTable(blockLines)
                    : blockType === "ul"
                    ? processListContent(blockLines)
                    : processBlock(blockLines, blockType);
                const li = document.createElement("li");
                li.appendChild(block);
                ul.appendChild(li);
              }
              i++;
              continue;
            }

            // å¤„ç†æ ‡é¢˜
            if (trimmedLine.startsWith("h3")) {
              const li = document.createElement("li");
              li.appendChild(createHeading(line, true));
              ul.appendChild(li);
              i++;
            } else if (
              trimmedLine.startsWith("h4") ||
              trimmedLine.startsWith("h5")
            ) {
              const li = document.createElement("li");
              li.appendChild(createHeading(line, false));
              ul.appendChild(li);
              i++;
            }
            // å¤„ç†æ™®é€šå†…å®¹ï¼ˆåŒ…æ‹¬ç©ºè¡Œå’Œå›¾ç‰‡ï¼‰
            else {
              const lineDiv = createLine(line, listContainer);
              const li = document.createElement("li");
              if (lineDiv.className === "empty-line") {
                li.innerHTML = "&nbsp;";
                li.style.height = "1.6em";
                li.style.listStyleType = "none";
                li.style.marginLeft = "-20px";
              } else {
                li.appendChild(lineDiv);
              }
              ul.appendChild(li);
              i++;
            }
          }

          listContainer.appendChild(ul);
          return listContainer;
        }

        // ===== å›¾ç‰‡æŸ¥çœ‹å™¨åŠŸèƒ½ =====
        function openModal(imgSrc) {
          domCache.loadingIndicator.style.display = "block";
          domCache.imageModal.style.display = "block";

          state.currentImageIndex = state.allImages.indexOf(imgSrc);
          state.currentScale = 1;
          state.translateX = 0;
          state.translateY = 0;

          domCache.modalImage.onload = function () {
            domCache.loadingIndicator.style.display = "none";
            updateImageInfo();
            updateImageTransform();
          };

          domCache.modalImage.onerror = function () {
            domCache.loadingIndicator.style.display = "none";
            domCache.modalImage.alt = "å›¾ç‰‡åŠ è½½å¤±è´¥";
            updateImageInfo();
          };

          domCache.modalImage.src = imgSrc;

          // é¢„åŠ è½½ä¸‹ä¸€å¼ å›¾ç‰‡
          preloadNextImage();
        }

        // é¢„åŠ è½½ä¸‹ä¸€å¼ å›¾ç‰‡
        function preloadNextImage() {
          const nextIndex =
            (state.currentImageIndex + 1) % state.allImages.length;
          if (nextIndex !== state.preloadIndex) {
            state.preloadIndex = nextIndex;
            const img = new Image();
            img.src = state.allImages[nextIndex];
          }
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
          domCache.imageModal.style.display = "none";
          domCache.modalImage.className = "modal-content";
        }

        // æ›´æ–°å›¾ç‰‡ä¿¡æ¯
        function updateImageInfo() {
          domCache.imageInfo.textContent = `å›¾ç‰‡ ${
            state.currentImageIndex + 1
          } / ${state.allImages.length}`;
        }

        // æ˜¾ç¤ºä¸Šä¸€å¼ å›¾ç‰‡
        function showPrevImage() {
          if (state.allImages.length === 0) return;

          domCache.loadingIndicator.style.display = "block";
          state.currentImageIndex =
            (state.currentImageIndex - 1 + state.allImages.length) %
            state.allImages.length;
          domCache.modalImage.src = state.allImages[state.currentImageIndex];
          resetImageZoom();
          updateImageInfo();

          // é¢„åŠ è½½ä¸Šä¸€å¼ å›¾ç‰‡
          const prevIndex =
            (state.currentImageIndex - 1 + state.allImages.length) %
            state.allImages.length;
          const img = new Image();
          img.src = state.allImages[prevIndex];
        }

        // æ˜¾ç¤ºä¸‹ä¸€å¼ å›¾ç‰‡
        function showNextImage() {
          if (state.allImages.length === 0) return;

          domCache.loadingIndicator.style.display = "block";
          state.currentImageIndex =
            (state.currentImageIndex + 1) % state.allImages.length;
          domCache.modalImage.src = state.allImages[state.currentImageIndex];
          resetImageZoom();
          updateImageInfo();
          preloadNextImage();
        }

        // é‡ç½®å›¾ç‰‡ç¼©æ”¾
        function resetImageZoom() {
          state.currentScale = 1;
          state.translateX = 0;
          state.translateY = 0;
          updateImageTransform();
          domCache.modalImage.className = "modal-content";
        }

        // ç¼©æ”¾å›¾ç‰‡
        function zoomImage(scale) {
          state.currentScale = Math.max(0.5, Math.min(scale, 3)); // é™åˆ¶ç¼©æ”¾èŒƒå›´
          updateImageTransform();

          // æ ¹æ®å½“å‰ç¼©æ”¾çŠ¶æ€åˆ‡æ¢å…‰æ ‡æ ·å¼
          if (state.currentScale === 1) {
            domCache.modalImage.className = "modal-content";
          } else {
            domCache.modalImage.className = "modal-content draggable";
          }
        }

        // æ›´æ–°å›¾ç‰‡å˜æ¢
        function updateImageTransform() {
          domCache.modalImage.style.transform = `translate(calc(-50% + ${state.translateX}px), calc(-50% + ${state.translateY}px)) scale(${state.currentScale})`;
        }

        // å¼€å§‹æ‹–åŠ¨
        function startDrag(e) {
          if (state.currentScale > 1) {
            state.isDragging = true;
            state.startX = e.clientX - state.translateX;
            state.startY = e.clientY - state.translateY;
            domCache.modalImage.classList.add("dragging");
            e.preventDefault();
          }
        }

        // å¤„ç†æ‹–åŠ¨
        function handleDrag(e) {
          if (state.isDragging) {
            state.translateX = e.clientX - state.startX;
            state.translateY = e.clientY - state.startY;
            updateImageTransform();
            e.preventDefault();
          }
        }

        // ç»“æŸæ‹–åŠ¨
        function endDrag(e) {
          if (state.isDragging) {
            state.isDragging = false;
            domCache.modalImage.classList.remove("dragging");
            e.stopPropagation();
            e.preventDefault();
          }
        }

        // å¤„ç†æ»šè½®ç¼©æ”¾
        function handleWheelZoom(e) {
          // åªæœ‰å›¾ç‰‡æŸ¥çœ‹å™¨æ‰“å¼€æ—¶æ‰å¤„ç†
          if (domCache.imageModal.style.display !== "block") return;

          e.preventDefault();
          e.stopPropagation();

          // è®¡ç®—ç¼©æ”¾ä¸­å¿ƒç‚¹ï¼ˆç›¸å¯¹äºå›¾ç‰‡ï¼‰
          const rect = domCache.modalImage.getBoundingClientRect();
          const centerX = e.clientX - rect.left;
          const centerY = e.clientY - rect.top;

          // è®¡ç®—å½“å‰é¼ æ ‡ä½ç½®åœ¨å›¾ç‰‡åæ ‡ç³»ä¸­çš„ä½ç½®ï¼ˆè€ƒè™‘å½“å‰ç¼©æ”¾å’Œå¹³ç§»ï¼‰
          const imgX =
            (centerX - rect.width / 2 - state.translateX) / state.currentScale;
          const imgY =
            (centerY - rect.height / 2 - state.translateY) / state.currentScale;

          // æ ¹æ®æ»šè½®æ–¹å‘è°ƒæ•´ç¼©æ”¾æ¯”ä¾‹
          const delta = -e.deltaY;
          const zoomFactor = 0.1; // ç¼©æ”¾é€Ÿåº¦
          const newScale =
            state.currentScale * (1 + (delta > 0 ? zoomFactor : -zoomFactor));

          // é™åˆ¶ç¼©æ”¾èŒƒå›´
          const clampedScale = Math.max(0.5, Math.min(newScale, 3));
          if (clampedScale === state.currentScale) return;

          // è®¡ç®—ç¼©æ”¾åé¼ æ ‡ä½ç½®åº”ä¿æŒä¸å˜
          const scaleChange = clampedScale / state.currentScale;
          state.translateX = centerX - rect.width / 2 - imgX * clampedScale;
          state.translateY = centerY - rect.height / 2 - imgY * clampedScale;
          state.currentScale = clampedScale;

          // æ›´æ–°å›¾ç‰‡å˜æ¢
          updateImageTransform();

          // æ ¹æ®å½“å‰ç¼©æ”¾çŠ¶æ€åˆ‡æ¢å…‰æ ‡æ ·å¼
          if (state.currentScale === 1) {
            domCache.modalImage.className = "modal-content";
          } else {
            domCache.modalImage.className = "modal-content draggable";
          }
        }

        // å¤„ç†æ”¾å¤§
        function handleZoomIn(e) {
          e.stopPropagation();
          zoomImage(state.currentScale + 0.5);
        }

        // å¤„ç†ç¼©å°
        function handleZoomOut(e) {
          e.stopPropagation();
          zoomImage(state.currentScale - 0.5);
        }

        // å¤„ç†é‡ç½®ç¼©æ”¾
        function handleZoomReset(e) {
          e.stopPropagation();
          resetImageZoom();
        }

        // ===== é”®ç›˜äº‹ä»¶å¤„ç† =====
        function handleKeyDown(event) {
          if (domCache.imageModal.style.display === "block") {
            switch (event.key) {
              case "ArrowLeft":
                showPrevImage();
                break;
              case "ArrowRight":
                showNextImage();
                break;
              case "Escape":
                closeModal();
                break;
              case "+":
              case "=":
                handleZoomIn(event);
                break;
              case "-":
                handleZoomOut(event);
                break;
              case "0":
                handleZoomReset(event);
                break;
            }
          }
        }

        // ===== åˆå§‹åŒ–åº”ç”¨ =====
        init();
      })();

      // ===== è‡ªå®šä¹‰ Tooltip åŠŸèƒ½å¯¼èˆªé¼ æ ‡æ‚¬åœæ˜¾ç¤º =====
      /* æ—§ç‰ˆæœ¬
      (function () {
        let tooltipEl = null;

        function showTooltip(target) {
          const text = target.getAttribute("data-tooltip");
          if (!text) return;

          if (!tooltipEl) {
            tooltipEl = document.createElement("div");
            tooltipEl.className = "tooltip";
            document.body.appendChild(tooltipEl);
          }

          tooltipEl.textContent = text;

          // ğŸ”‘ æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—ä½ç½®ï¼Œé¿å…ç‚¹å‡»è·³è½¬åé”™ä½
          const rect = target.getBoundingClientRect();
          tooltipEl.style.top =
            rect.top + rect.height / 2 + window.scrollY + "px";
          tooltipEl.style.left = rect.right + 10 + window.scrollX + "px";

          tooltipEl.classList.add("show");
        }

        function hideTooltip() {
          if (tooltipEl) {
            tooltipEl.classList.remove("show");
          }
        }

        const sidebar = document.getElementById("sidebar");

        sidebar.addEventListener("mouseover", (e) => {
          if (e.target.classList.contains("nav-item-icon")) {
            showTooltip(e.target);
          }
        });

        sidebar.addEventListener("mouseout", (e) => {
          if (e.target.classList.contains("nav-item-icon")) {
            hideTooltip();
          }
        });

        // ğŸ”‘ ç‚¹å‡»åå¼ºåˆ¶éšè—ï¼Œä¿è¯æ‚¬åœèƒ½å†æ¬¡è§¦å‘
        sidebar.addEventListener("click", (e) => {
          if (tooltipEl) {
            tooltipEl.classList.remove("show");
          }
        });
      })();
      */
      (function () {
        let tooltipEl = null;
        let tooltipTimer;

        function showTooltip(target) {
          const text = target.getAttribute("data-tooltip");
          if (!text) return;

          if (!tooltipEl) {
            tooltipEl = document.createElement("div");
            tooltipEl.className = "tooltip";
            document.body.appendChild(tooltipEl);
          }

          tooltipEl.textContent = text;

          // æ ¹æ®å›¾æ ‡ç±»å‹åŠ ä¸åŒä¸»é¢˜
          tooltipEl.className = "tooltip"; // reset
          if (target.classList.contains("warning")) {
            tooltipEl.classList.add("warning");
          } else if (target.classList.contains("success")) {
            tooltipEl.classList.add("success");
          } else if (target.classList.contains("error")) {
            tooltipEl.classList.add("error");
          } else {
            tooltipEl.classList.add("info");
          }

          // åŠ¨æ€è®¡ç®—ä½ç½®
          const rect = target.getBoundingClientRect();
          tooltipEl.style.top =
            rect.top + rect.height / 2 + window.scrollY + "px";
          tooltipEl.style.left = rect.right + 10 + window.scrollX + "px";

          tooltipEl.classList.add("show");
        }

        function hideTooltip() {
          if (tooltipEl) tooltipEl.classList.remove("show");
        }

        const sidebar = document.getElementById("sidebar");

        sidebar.addEventListener("mouseover", (e) => {
          if (e.target.classList.contains("nav-item-icon")) {
            tooltipTimer = setTimeout(() => showTooltip(e.target), 100);
          }
        });

        sidebar.addEventListener("mouseout", (e) => {
          if (e.target.classList.contains("nav-item-icon")) {
            clearTimeout(tooltipTimer);
            hideTooltip();
          }
        });

        sidebar.addEventListener("click", () => {
          if (tooltipEl) tooltipEl.classList.remove("show");
        });
      })();
    </script>
  </body>
</html>
